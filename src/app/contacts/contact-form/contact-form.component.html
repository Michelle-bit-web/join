<section>
  <div class="close-btn-wrapper">
    <button class="btn-close" (click)="onClose()">
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <mask
          id="mask0_331509_883"
          style="mask-type: alpha"
          maskUnits="userSpaceOnUse"
          x="0"
          y="0"
          width="24"
          height="24"
        >
          <rect width="24" height="24" fill="#D9D9D9" />
        </mask>
        <g mask="url(#mask0_331509_883)">
          <path
            d="M12 13.4L7.10005 18.3C6.91672 18.4834 6.68338 18.575 6.40005 18.575C6.11672 18.575 5.88338 18.4834 5.70005 18.3C5.51672 18.1167 5.42505 17.8834 5.42505 17.6C5.42505 17.3167 5.51672 17.0834 5.70005 16.9L10.6 12L5.70005 7.10005C5.51672 6.91672 5.42505 6.68338 5.42505 6.40005C5.42505 6.11672 5.51672 5.88338 5.70005 5.70005C5.88338 5.51672 6.11672 5.42505 6.40005 5.42505C6.68338 5.42505 6.91672 5.51672 7.10005 5.70005L12 10.6L16.9 5.70005C17.0834 5.51672 17.3167 5.42505 17.6 5.42505C17.8834 5.42505 18.1167 5.51672 18.3 5.70005C18.4834 5.88338 18.575 6.11672 18.575 6.40005C18.575 6.68338 18.4834 6.91672 18.3 7.10005L13.4 12L18.3 16.9C18.4834 17.0834 18.575 17.3167 18.575 17.6C18.575 17.8834 18.4834 18.1167 18.3 18.3C18.1167 18.4834 17.8834 18.575 17.6 18.575C17.3167 18.575 17.0834 18.4834 16.9 18.3L12 13.4Z"
            fill="#2A3647"
          />
        </g>
      </svg>
    </button>
  </div>
  <div class="left-frame">
    <img src="assets/img/logo/logo.png" alt="Join Logo" class="logo" />
    <h1 *ngIf="!contactToEdit">Add contact</h1>
    <h1 *ngIf="contactToEdit">Edit contact</h1>
    <p class="sub-heading" *ngIf="!contactToEdit">
      Tasks are better with a team!
    </p>
    <div class="separator"></div>
  </div>
  <div class="right-frame">
    <div class="form-wrapper">
      <div
        class="img-user-wrapper"
        [style.background-color]="
          contactToEdit && !contactToEdit.imageKey
            ? 'transparent'
            : contactToEdit
            ? contactService.getContactColor(contactToEdit.name)
            : '#d1d1d1'
        "
      >
        <!-- Bild aus localStorage -->
        <img
          class="contact-image"
          [src]="imageBase64"
          alt="User Image"
          *ngIf="imageBase64"
        />
        <img
          class="img-user"
          src="assets/img/svg/person.svg"
          alt="User Image"
          *ngIf="!imageBase64 && !contactToEdit"
        />
         <div class="image-overlay" *ngIf="imageBase64">
              <button class="remove-btn" (click)="removeImage(); $event.stopPropagation()">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 4L4 12M4 4L12 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
          </div>
        <p
          class="contact-initials"
          *ngIf="!imageBase64 && contactToEdit"
        >
          {{ contactService.getInitials(contactToEdit.name) }}
        </p>
        <input
          class="file-picker"
          type="file"
          id="filepicker"
          name="uploadInput"
          placeholder="Upload files"
          accept="image/*"
          [multiple]="false"
          (change)="onContactImageChanged($event)"
          #filepicker
        />
        <svg
          (click)="openFileDialog()"
          class="upload-icon"
          width="54"
          height="54"
          viewBox="0 0 54 54"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g filter="url(#filter0_d_261948_10950)">
            <rect x="4" y="4" width="46" height="46" rx="23" fill="white" />
            <path
              d="M40.125 34.5C40.125 34.9973 39.9275 35.4742 39.5758 35.8258C39.2242 36.1775 38.7473 36.375 38.25 36.375H15.75C15.2527 36.375 14.7758 36.1775 14.4242 35.8258C14.0725 35.4742 13.875 34.9973 13.875 34.5V23.25C13.875 22.7527 14.0725 22.2758 14.4242 21.9242C14.7758 21.5725 15.2527 21.375 15.75 21.375H17.9475C19.4386 21.3742 20.8683 20.7814 21.9225 19.7269L23.4788 18.1744C23.8294 17.8236 24.3047 17.6261 24.8006 17.625H29.1956C29.6929 17.6251 30.1697 17.8227 30.5212 18.1744L32.0738 19.7269C32.5962 20.2495 33.2165 20.664 33.8992 20.9468C34.5818 21.2296 35.3136 21.3751 36.0525 21.375H38.25C38.7473 21.375 39.2242 21.5725 39.5758 21.9242C39.9275 22.2758 40.125 22.7527 40.125 23.25V34.5ZM15.75 19.5C14.7554 19.5 13.8016 19.8951 13.0983 20.5983C12.3951 21.3016 12 22.2554 12 23.25V34.5C12 35.4946 12.3951 36.4484 13.0983 37.1516C13.8016 37.8549 14.7554 38.25 15.75 38.25H38.25C39.2446 38.25 40.1984 37.8549 40.9016 37.1516C41.6049 36.4484 42 35.4946 42 34.5V23.25C42 22.2554 41.6049 21.3016 40.9016 20.5983C40.1984 19.8951 39.2446 19.5 38.25 19.5H36.0525C35.058 19.4998 34.1043 19.1046 33.4012 18.4013L31.8488 16.8487C31.1457 16.1454 30.192 15.7502 29.1975 15.75H24.8025C23.808 15.7502 22.8543 16.1454 22.1512 16.8487L20.5988 18.4013C19.8957 19.1046 18.942 19.4998 17.9475 19.5H15.75Z"
              fill="#2A3647"
            />
            <path
              d="M27 32.625C25.7568 32.625 24.5645 32.1311 23.6854 31.2521C22.8064 30.373 22.3125 29.1807 22.3125 27.9375C22.3125 26.6943 22.8064 25.502 23.6854 24.6229C24.5645 23.7439 25.7568 23.25 27 23.25C28.2432 23.25 29.4355 23.7439 30.3146 24.6229C31.1936 25.502 31.6875 26.6943 31.6875 27.9375C31.6875 29.1807 31.1936 30.373 30.3146 31.2521C29.4355 32.1311 28.2432 32.625 27 32.625ZM27 34.5C28.7405 34.5 30.4097 33.8086 31.6404 32.5779C32.8711 31.3472 33.5625 29.678 33.5625 27.9375C33.5625 26.197 32.8711 24.5278 31.6404 23.2971C30.4097 22.0664 28.7405 21.375 27 21.375C25.2595 21.375 23.5903 22.0664 22.3596 23.2971C21.1289 24.5278 20.4375 26.197 20.4375 27.9375C20.4375 29.678 21.1289 31.3472 22.3596 32.5779C23.5903 33.8086 25.2595 34.5 27 34.5ZM17.625 24.1875C17.625 24.4361 17.5262 24.6746 17.3504 24.8504C17.1746 25.0262 16.9361 25.125 16.6875 25.125C16.4389 25.125 16.2004 25.0262 16.0246 24.8504C15.8488 24.6746 15.75 24.4361 15.75 24.1875C15.75 23.9389 15.8488 23.7004 16.0246 23.5246C16.2004 23.3488 16.4389 23.25 16.6875 23.25C16.9361 23.25 17.1746 23.3488 17.3504 23.5246C17.5262 23.7004 17.625 23.9389 17.625 24.1875Z"
              fill="#2A3647"
            />
          </g>
          <defs>
            <filter
              id="filter0_d_261948_10950"
              x="0"
              y="0"
              width="54"
              height="54"
              filterUnits="userSpaceOnUse"
              color-interpolation-filters="sRGB"
            >
              <feFlood flood-opacity="0" result="BackgroundImageFix" />
              <feColorMatrix
                in="SourceAlpha"
                type="matrix"
                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
                result="hardAlpha"
              />
              <feOffset />
              <feGaussianBlur stdDeviation="2" />
              <feColorMatrix
                type="matrix"
                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"
              />
              <feBlend
                mode="normal"
                in2="BackgroundImageFix"
                result="effect1_dropShadow_261948_10950"
              />
              <feBlend
                mode="normal"
                in="SourceGraphic"
                in2="effect1_dropShadow_261948_10950"
                result="shape"
              />
            </filter>
          </defs>
        </svg>
      </div>
      <form [formGroup]="contactForm" (ngSubmit)="onSubmit()">
        <div class="form-group-wrapper">
          <div
            class="form-group"
            [ngClass]="{
              colorError:
                contactForm.get('name')?.invalid &&
                contactForm.get('name')?.touched
            }"
          >
            <label for="name"></label>
            <input
              id="name"
              type="text"
              placeholder="Name"
              formControlName="name"
            />
            <img
              class="input-icon"
              src="assets/img/icons/person.png"
              alt="Person Icon"
            />
          </div>
          <p
            class="error-message"
            *ngIf="
              contactForm.get('name')?.invalid &&
              contactForm.get('name')?.touched
            "
          >
            Oops! Please add a name.
          </p>
        </div>
        <div class="form-group-wrapper">
          <div
            class="form-group"
            [ngClass]="{
              colorError:
                contactForm.get('email')?.invalid &&
                contactForm.get('email')?.touched
            }"
          >
            <label for="email"></label>
            <input
              id="email"
              type="text"
              placeholder="Email"
              formControlName="email"
            />
            <img
              class="input-icon"
              src="assets/img/icons/mail.png"
              alt="Mail Icon"
            />
          </div>
          <p
            class="error-message"
            *ngIf="
              contactForm.get('email')?.invalid &&
              contactForm.get('email')?.touched
            "
          >
            Oops! This email seems invalid or missing.
          </p>
        </div>
        <div class="form-group-wrapper">
          <div
            class="form-group"
            [ngClass]="{
              colorError:
                contactForm.get('phone')?.invalid &&
                contactForm.get('phone')?.touched
            }"
          >
            <label for="phone"></label>
            <input
              id="phone"
              type="text"
              placeholder="Phone"
              formControlName="phone"
            />
            <img
              class="input-icon"
              src="assets/img/icons/phone.png"
              alt="Phone Icon"
            />
          </div>
          <p
            class="error-message"
            *ngIf="
              contactForm.get('phone')?.invalid &&
              contactForm.get('phone')?.touched
            "
          >
            Oh! Don´t forget the phone number.
          </p>
        </div>
        <div class="btn-wrapper">
          <button
            class="btn-cancel"
            type="reset"
            *ngIf="!contactToEdit"
            (click)="onClose()"
          >
            Cancel
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <mask
                id="mask0_331509_883"
                style="mask-type: alpha"
                maskUnits="userSpaceOnUse"
                x="0"
                y="0"
                width="24"
                height="24"
              >
                <rect width="24" height="24" fill="#D9D9D9" />
              </mask>
              <g mask="url(#mask0_331509_883)">
                <path
                  d="M12 13.4L7.10005 18.3C6.91672 18.4834 6.68338 18.575 6.40005 18.575C6.11672 18.575 5.88338 18.4834 5.70005 18.3C5.51672 18.1167 5.42505 17.8834 5.42505 17.6C5.42505 17.3167 5.51672 17.0834 5.70005 16.9L10.6 12L5.70005 7.10005C5.51672 6.91672 5.42505 6.68338 5.42505 6.40005C5.42505 6.11672 5.51672 5.88338 5.70005 5.70005C5.88338 5.51672 6.11672 5.42505 6.40005 5.42505C6.68338 5.42505 6.91672 5.51672 7.10005 5.70005L12 10.6L16.9 5.70005C17.0834 5.51672 17.3167 5.42505 17.6 5.42505C17.8834 5.42505 18.1167 5.51672 18.3 5.70005C18.4834 5.88338 18.575 6.11672 18.575 6.40005C18.575 6.68338 18.4834 6.91672 18.3 7.10005L13.4 12L18.3 16.9C18.4834 17.0834 18.575 17.3167 18.575 17.6C18.575 17.8834 18.4834 18.1167 18.3 18.3C18.1167 18.4834 17.8834 18.575 17.6 18.575C17.3167 18.575 17.0834 18.4834 16.9 18.3L12 13.4Z"
                  fill="#2A3647"
                />
              </g>
            </svg>
          </button>
          <button
            class="btn-delete"
            *ngIf="contactToEdit"
            (click)="deleteContact()"
          >
            Delete
          </button>
          <button
            class="btn-save"
            type="submit"
            *ngIf="!contactToEdit"
            [disabled]="contactForm.invalid"
          >
            Create contact
            <img src="assets/img/icons/check-light.png" alt="Checked Icon" />
          </button>
          <button
            class="btn-edit"
            type="submit"
            [disabled]="contactForm.invalid"
            *ngIf="contactToEdit"
          >
            Save
            <img src="assets/img/icons/check-light.png" alt="Checked Icon" />
          </button>
        </div>
      </form>
    </div>
  </div>
</section>
